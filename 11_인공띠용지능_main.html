<!DOCTYPE html>
<html lang="ko" id="top">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>냠냠노트 - 메인 페이지</title>
    <link rel="stylesheet" href="11_인공띠용지능_NamyamNote_style.css" />
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const hasLoggedIn = localStorage.getItem('hasLoggedInBefore');

        if (!hasLoggedIn) {
          location.href = '11_인공띠용지능_login.html';
        }
      });
    </script>

    <style>
      .hero-section {
        display: flex;
        justify-content: center;
        align-items: center;
        background: #fffaf2;
        border-radius: 20px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
        margin: 40px auto;
        overflow: hidden;
        max-width: 1100px;
        padding: 40px 60px;
      }

      .hero-content {
        display: flex;
        align-items: center;
        justify-content: space-between;
        width: 100%;
        gap: 40px;
      }

      .hero-text-wrap {
        flex: 1;
      }

      .hero-subtitle {
        color: #916b46;
        font-weight: 700;
        font-size: 1rem;
        margin-bottom: 8px;
      }

      .hero-title-new {
        font-size: 2.8rem;
        font-weight: 800;
        color: #47331b;
        margin-bottom: 20px;
      }

      .brand-line {
        color: #47331b;
      }

      .hero-description {
        color: #555;
        line-height: 1.6;
        margin-bottom: 24px;
      }

      .hero-buttons {
        display: flex;
        gap: 12px;
      }

      .hero-btn {
        display: inline-block;
        padding: 10px 22px;
        border-radius: 12px;
        font-weight: 700;
        text-decoration: none;
        transition: all 0.3s ease;
      }

      .hero-btn-primary {
        background: #916b46;
        color: #fff;
      }

      .hero-btn-primary:hover {
        background: #ac8d6f;
      }

      .hero-btn-secondary {
        background: #f6e8c9;
        color: #916b46;
        border: 1.5px solid #e2c97a;
      }

      .hero-btn-secondary:hover {
        background: #ecdeb5;
      }

      .hero-visual {
        flex: 1;
        text-align: center;
      }

      .hero-visual-img {
        width: 100%;
        max-width: 500px;
        border-radius: 16px;
        border: 1px solid #e4d8b4;
        box-shadow: 0 4px 14px rgba(0, 0, 0, 0.05);
        height: 580px;
        object-fit: cover;
        transition: opacity 0.4s ease-in-out;
      }

      @media (max-width: 768px) {
        .hero-section {
          flex-direction: column;
          padding: 30px 20px;
        }

        .hero-content {
          flex-direction: column;
          text-align: center;
        }

        .hero-visual-img {
          margin-top: 20px;
        }
      }
    </style>
  </head>

  <body>
    <nav class="site-nav">
      <div class="container nav-top-center">
        <div class="nav-center-box">
          <a href="11_인공띠용지능_main.html" aria-label="냠냠노트 홈">
            <img src="11_logo.png" alt="냠냠노트 로고" class="logo" />
          </a>
          <div class="nav-search">
            <input
              type="text"
              placeholder="재료명으로 레시피 검색"
              class="nav-search-input"
            />
            <button class="nav-search-btn">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                <circle cx="11" cy="11" r="7" stroke="white" stroke-width="2" />
                <line
                  x1="16.5"
                  y1="16.5"
                  x2="21"
                  y2="21"
                  stroke="white"
                  stroke-width="2"
                />
              </svg>
            </button>
          </div>
        </div>
      </div>
      <div class="nav-menu-bar">
        <a class="active nav-link" href="11_인공띠용지능_main.html">홈</a>
        <a class="nav-link" href="11_인공띠용지능_menulist.html">레시피</a>
        <a class="nav-link" href="11_인공띠용지능_register.html">등록</a>
        <a class="nav-link" href="11_인공띠용지능_rank.html#ranking">랭킹</a>
        <a class="nav-link" href="11_인공띠용지능_mypage.html">마이페이지</a>
      </div>
    </nav>

    <main class="container page-pad">
      <section class="hero-section" aria-label="메인 배너">
        <div class="hero-content">
          <div class="hero-text-wrap">
            <p class="hero-subtitle">맛과 영양을 고려한 맞춤형 식단</p>
            <h1 class="hero-title-new">
              Today's <span class="brand-line">menu</span>
            </h1>
            <p class="hero-description">
              냠냠노트는 쉽고 맛있는 레시피를 제공하여,<br />
              누구나 만족하는 특별한 요리를 완성할 수 있도록 돕습니다.
            </p>
            <div class="hero-buttons">
              <a
                href="11_인공띠용지능_menulist.html"
                class="hero-btn hero-btn-primary"
                >레시피 보러가기</a
              >
              <a
                href="11_인공띠용지능_register.html"
                class="hero-btn hero-btn-secondary"
                >나만의 레시피 등록</a
              >
            </div>
          </div>
          <div class="hero-visual">
            <img
              id="hero-carousel"
              src="11_banner.jpg"
              alt="요리 이미지"
              class="hero-visual-img"
            />
          </div>
        </div>
      </section>

      <h2 class="section-title">카테고리별 레시피 탐색</h2>
      <div class="cat-grid" aria-label="레시피 카테고리">
        <a
          class="cat-card"
          href="11_인공띠용지능_menulist_full.html?category=korean"
        >
          <img src="11_kimchi.jpg" alt="한식 이미지" />
          <div class="cat-overlay">
            <span class="cat-btn"><span class="cat-emoji"></span>한식</span>
          </div>
        </a>

        <a
          class="cat-card"
          href="11_인공띠용지능_menulist_full.html?category=western"
        >
          <img src="11_pasta.jpg" alt="양식 이미지" />
          <div class="cat-overlay">
            <span class="cat-btn"><span class="cat-emoji"></span>양식</span>
          </div>
        </a>

        <a
          class="cat-card"
          href="11_인공띠용지능_menulist_full.html?category=chinese"
        >
          <img src="11_chinese.png" alt="중식 이미지" />
          <div class="cat-overlay">
            <span class="cat-btn"><span class="cat-emoji"></span>중식</span>
          </div>
        </a>

        <a
          class="cat-card"
          href="11_인공띠용지능_menulist_full.html?category=dessert"
        >
          <img src="11_snack.jpg" alt="디저트 이미지" />
          <div class="cat-overlay">
            <span class="cat-btn"><span class="cat-emoji"></span>디저트</span>
          </div>
        </a>

        <a
          class="cat-card"
          href="11_인공띠용지능_menulist_full.html?category=drink"
        >
          <img src="11_drink.png" alt="음료 이미지" />
          <div class="cat-overlay">
            <span class="cat-btn"><span class="cat-emoji"></span>음료</span>
          </div>
        </a>
      </div>

      <section class="mt-60" aria-label="추천 레시피">
        <h2 class="section-title">오늘의 추천 레시피</h2>

        <div id="recommend-list" class="card-grid"></div>

        <div class="center mt-20">
          <a href="11_인공띠용지능_menulist.html" class="more-btn">더보기 →</a>
        </div>
      </section>
    </main>

    <a href="#top" class="to-top" aria-label="맨 위로 이동">맨 위로 ↑</a>

    <script>
      async function loadRecipes() {
        const response = await fetch('11_인공띠용지능_recipes.json');
        const data = await response.json();
        return data.recipes;
      }

      function loadReviews(recipeId) {
        const key = 'nn_reviews_' + recipeId;
        try {
          const data = localStorage.getItem(key);
          return data ? JSON.parse(data) : [];
        } catch {
          return [];
        }
      }

      function getAverageRating(recipeId) {
        const reviews = loadReviews(recipeId);
        if (reviews.length === 0) return 0;

        const sum = reviews.reduce((acc, r) => acc + Number(r.rating), 0);
        return sum / reviews.length;
      }

      function getRandomRecipes(list, count) {
        return [...list].sort(() => Math.random() - 0.5).slice(0, count);
      }

      async function renderRandomRecipes() {
        const target = document.getElementById('recommend-list');
        const recipes = await loadRecipes();
        const selected = getRandomRecipes(recipes, 4);

        target.innerHTML = selected
          .map((r) => {
            const avg = getAverageRating(r.id);
            const displayRating = `★ ${avg.toFixed(1)}`;

            return `
          <a href="11_인공띠용지능_recipe.html?id=${r.id}" class="card">
            <img src="${r.thumbnail}" class="thumb" alt="${r.title}">
            <p class="card-title">${r.title}</p>
            <div class="rating">${displayRating}</div>
          </a>
        `;
          })
          .join('');
      }

      renderRandomRecipes();
    </script>

    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const navInput = document.querySelector('.nav-search-input');
        const navBtn = document.querySelector('.nav-search-btn');

        if (!navInput || !navBtn) return;

        navBtn.addEventListener('click', () => {
          const kw = navInput.value.trim();
          if (!kw) {
            alert('검색어를 입력해주세요!');
            return;
          }

          location.href =
            '11_인공띠용지능_search.html?keyword=' + encodeURIComponent(kw);
        });

        navInput.addEventListener('keydown', (e) => {
          if (e.key === 'Enter') {
            navBtn.click();
          }
        });
      });
    </script>

    <script>
      const carouselImages = [
        '11_banner.jpg',
        '11_banner2.jpg',
        '11_banner3.jpg',
        '11_banner4.jpg',
      ];
      let currentIndex = 0;
      const carouselImg = document.getElementById('hero-carousel');

      function changeCarousel() {
        currentIndex = (currentIndex + 1) % carouselImages.length;
        carouselImg.style.opacity = 0;
        setTimeout(() => {
          carouselImg.src = carouselImages[currentIndex];
          carouselImg.style.opacity = 1;
        }, 300);
      }

      setInterval(changeCarousel, 3000);
    </script>
  </body>
</html>

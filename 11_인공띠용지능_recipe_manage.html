<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>ëƒ ëƒ ë…¸íŠ¸ - ë ˆì‹œí”¼ ê´€ë¦¬</title>

    <!-- ê³µí†µ ìŠ¤íƒ€ì¼ (í™ˆ/ë­í‚¹ê³¼ ë™ì¼) -->
    <link rel="stylesheet" href="11_ì¸ê³µë ìš©ì§€ëŠ¥_NamyamNote_style.css" />

    <style>
      /* ë ˆì‹œí”¼ ê´€ë¦¬ ì „ìš© ìŠ¤íƒ€ì¼ */

      #ranking .manage-empty-text {
        margin-top: 20px;
        font-size: 14px;
        color: var(--muted);
        text-align: center;
      }

      #ranking .manage-list {
        display: flex;
        flex-direction: column;
        gap: 16px;
        margin-top: 24px;

    }


      /* ë­í‚¹ ì¹´ë“œ ìŠ¤íƒ€ì¼ ì¬í™œìš© */
      #ranking .rank-card {
        display: flex;
        align-items: center;
        background: #fff;
        padding: 16px;
        border-radius: 16px;
        border: 1px solid var(--border);
        box-shadow: var(--shadow);
        transition: transform 0.25s, box-shadow 0.25s;
      }

      #ranking .rank-card:hover {
        transform: translateY(-4px);
        box-shadow: var(--shadow-lg);
      }

      #ranking .rank-card-image {
        width: 110px;
        height: 90px;
        object-fit: cover;
        border-radius: 12px;
        margin-right: 16px;
        flex-shrink: 0;
        background: #f3f4f6;
      }

      #ranking .rank-info {
        flex-grow: 1;
        min-width: 0;
      }

      /* ì…ë ¥ í•„ë“œ (ì œëª©/ì¹´í…Œê³ ë¦¬) */
      #ranking .manage-input {
        width: 100%;
        padding: 8px 10px;
        font-size: 14px;
        border: 1px solid #ddd;
        border-radius: 10px;
        margin-bottom: 8px;
        box-sizing: border-box;
        font-family: inherit;
      }

      #ranking .manage-input:focus {
        border-color: var(--primary-color);
        box-shadow: 0 0 0 2px rgba(145, 107, 70, 0.15);
        outline: none;
      }

      #ranking .recipe-meta {
        font-size: 12px;
        color: var(--muted);
      }

      /* ì˜¤ë¥¸ìª½ ë²„íŠ¼ ì˜ì—­ */
      #ranking .rank-meta {
        text-align: right;
        margin-left: 12px;
        flex-shrink: 0;
        display: flex;
        flex-direction: column;
        justify-content: center;
      }

      #ranking .manage-actions {
        display: flex;
        gap: 6px;
        justify-content: flex-end;
      }

      #ranking .btn-edit,
      #ranking .btn-delete {
        min-width: 80px;
        height: 36px;
        padding: 0 12px;
        font-size: 14px;
        border-radius: 999px;
        border: 1px solid var(--border);
        background: #fff;
        cursor: pointer;
        font-weight: 700;
      }

      #ranking .btn-edit {
        border-color: #d1d5db;
        color: var(--gray-deep);
      }

      #ranking .btn-edit:hover {
        background: #f3f4f6;
      }

      #ranking .btn-delete {
        border-color: #f97373;
        color: #c81e1e;
      }

      #ranking .btn-delete:hover {
        background: #fee2e2;
      }

      @media (max-width: 520px) {
        #ranking .rank-card {
          flex-direction: column;
          align-items: flex-start;
          gap: 12px;
        }
        #ranking .rank-card-image {
          width: 100%;
          height: 160px;
        }
        #ranking .rank-meta {
          width: 100%;
          text-align: right;
        }
      }
    </style>
  </head>

  <body>
    <a id="top"></a>

    <nav class="site-nav">
      <div class="container nav-inner">
        <div class="logo-area">
          <a href="11_ì¸ê³µë ìš©ì§€ëŠ¥_main.html">
            <img src="11_logo.png" alt="ëƒ ëƒ ë…¸íŠ¸ ë¡œê³ " class="logo-img" />
          </a>
        </div>

        <nav class="menu">
          <a href="11_ì¸ê³µë ìš©ì§€ëŠ¥_main.html" class="nav-link">í™ˆ</a>
          <a href="11_ì¸ê³µë ìš©ì§€ëŠ¥_menulist.html" class="nav-link">ë ˆì‹œí”¼</a>
          <a href="11_ì¸ê³µë ìš©ì§€ëŠ¥_register.html" class="nav-link">ë“±ë¡</a>
          <a href="11_ì¸ê³µë ìš©ì§€ëŠ¥_rank.html" class="nav-link">ë­í‚¹</a>
          <a href="11_ì¸ê³µë ìš©ì§€ëŠ¥_mypage.html" class="nav-link active"
            >ë§ˆì´í˜ì´ì§€</a
          >
        </nav>
      </div>
    </nav>

    <main class="page-pad">
      <div id="ranking" class="container">
        <header class="hero center">
          <h1 class="mt-0">ë‚´ ë ˆì‹œí”¼ ê´€ë¦¬</h1>
          <p style="font-size: 14px; color: var(--muted); margin-top: 6px;">
            ë“±ë¡í•œ ë ˆì‹œí”¼ì˜ ë‚´ìš©ì„ ìˆ˜ì •í•˜ê±°ë‚˜ ì‚­ì œí•  ìˆ˜ ìˆì–´ìš”.
          </p>
        </header>

        <h2 class="section-title">ë“±ë¡í•œ ë ˆì‹œí”¼ ëª©ë¡</h2>

        <p id="empty-text" class="manage-empty-text">
          ë“±ë¡ëœ ë ˆì‹œí”¼ê°€ ì—†ìŠµë‹ˆë‹¤.
        </p>

        <!-- ë­í‚¹ ë¦¬ìŠ¤íŠ¸ì™€ ìœ ì‚¬í•œ ì¹´ë“œ ë¦¬ìŠ¤íŠ¸ -->
        <div id="manageList" class="manage-list"></div>
      </div>
    </main>

    <a href="#top" class="to-top">ë§¨ ìœ„ë¡œ â†‘</a>

    <script>
      const KEY = 'nn_recipes';

      function loadRecipes() {
        try {
          return JSON.parse(localStorage.getItem(KEY)) || [];
        } catch (e) {
          return [];
        }
      }

      function saveRecipes(list) {
        localStorage.setItem(KEY, JSON.stringify(list));
      }

      function escapeHTML(str) {
        if (str == null) return '';
        return String(str)
          .replace(/&/g, '&amp;')
          .replace(/</g, '&lt;')
          .replace(/>/g, '&gt;')
          .replace(/"/g, '&quot;')
          .replace(/'/g, '&#39;');
      }

      function renderList() {
        const list = loadRecipes();
        const listEl = document.getElementById('manageList');
        const emptyText = document.getElementById('empty-text');

        if (!list.length) {
          emptyText.style.display = 'block';
          listEl.innerHTML = '';
          return;
        } else {
          emptyText.style.display = 'none';
        }

        listEl.innerHTML = '';

        list.forEach((r) => {
          const card = document.createElement('div');
          card.className = 'rank-card';
          card.setAttribute('data-id', r.id);

          const thumbSrc =
            r.image && r.image.trim()
              ? r.image
              : '11_background.png'; // ì¸ë„¤ì¼ ì—†ì„ ë•Œ ëŒ€ì²´ ì´ë¯¸ì§€

          card.innerHTML = `
            <img src="${thumbSrc}" class="rank-card-image" alt="${escapeHTML(
            r.title
          )}" />

            <div class="rank-info">
              <p class="recipe-meta" style="margin-bottom:4px;">
                ID: ${escapeHTML(r.id)}${
            r.createdAt
              ? ` Â· ë“±ë¡ì¼: ${new Date(r.createdAt)
                  .toLocaleDateString('ko-KR')
                  .replace(/\./g, '.')
                  .replace(/\s/g, '')}`
              : ''
          }${
            typeof r.views === 'number'
              ? ` Â· ì¡°íšŒìˆ˜ ${escapeHTML(r.views)}`
              : ''
          }
              </p>
              <p style="font-weight:700; margin-bottom:2px;">
                ${escapeHTML(r.title)}
              </p>
              <p style="font-size:13px; color:var(--muted);">
                ì¹´í…Œê³ ë¦¬: ${escapeHTML(r.category || 'ë¯¸ì§€ì •')}
              </p>
            </div>

            <div class="rank-meta">
              <div class="manage-actions">
                <button class="btn-edit">ìˆ˜ì •</button>
                <button class="btn-delete">ì‚­ì œ</button>
              </div>
            </div>
          `;

          listEl.appendChild(card);
        });
      }

      document.addEventListener('DOMContentLoaded', renderList);

      // ìˆ˜ì •/ì‚­ì œ ë²„íŠ¼ ì´ë²¤íŠ¸ (ì¹´ë“œ ìš°ì¸¡)
      document
        .getElementById('manageList')
        .addEventListener('click', function (e) {
          const target = e.target;
          if (
            !target.classList.contains('btn-edit') &&
            !target.classList.contains('btn-delete')
          )
            return;

          const card = target.closest('.rank-card');
          if (!card) return;

          const id = card.getAttribute('data-id');
          let list = loadRecipes();

          if (target.classList.contains('btn-edit')) {
            // ğŸ‘‰ ìˆ˜ì • í˜ì´ì§€(ë“±ë¡ í˜ì´ì§€)ë¡œ ì´ë™ (edit ëª¨ë“œ)
            const url =
              '11_ì¸ê³µë ìš©ì§€ëŠ¥_register.html?editId=' +
              encodeURIComponent(id);
            window.location.href = url;
          }

          if (target.classList.contains('btn-delete')) {
            // ğŸ‘‰ alert í›„ ì‚­ì œ
            list = list.filter((r) => String(r.id) !== String(id));
            saveRecipes(list);
            alert('ë ˆì‹œí”¼ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
            renderList();
          }
        });
    </script>
  </body>
</html>

<!DOCTYPE html>
<html lang="ko" id="top">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>냠냠노트 - 마이페이지</title>
    <link rel="stylesheet" href="11_인공띠용지능_NamyamNote_style.css" />
    <style>
      .follow {
        display: flex;
        align-items: center;
        justify-content: space-between;
        background: #f9fafb;
        border-top: 1px solid var(--border);
        padding: 12px 8px;
      }

      .follow > div {
        flex: 1;                 /* 3개의 박스 동일 너비 */
        text-align: center;       /* 숫자/라벨 중앙 */
      }

      .follow-num {
        display: block;
        color: var(--text);
        font-size: 20px;
        font-weight: 800;
      }

      .follow-label {
        display: block;
        color: var(--muted);
        font-size: 13px;
      }
      .profile-box {
        display: flex;
        flex-direction: column;
        align-items: center !important;  /* 가운데 정렬 강제 */
        text-align: center;              /* 텍스트도 중앙으로 */
      }


    </style>
  </head>
  <body>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // 1. 저장된 데이터 불러오기
        const savedNickname = localStorage.getItem("nn_nickname");
        const savedUsername = localStorage.getItem("nn_username");
        const savedBio = localStorage.getItem("nn_bio");
        const savedProfileImg = localStorage.getItem("nn_profile_img");
        const savedBgImg = localStorage.getItem("nn_bg_img");

        // 2. 데이터가 있다면 화면에 반영하기
        if (savedNickname) {
          document.querySelector(".profile-name").textContent = savedNickname;
        }
        if (savedUsername) {
          document.querySelector(".profile-id").textContent = savedUsername;
        }
        if (savedBio) {
          document.querySelector(".profile-bio").textContent = savedBio;
        }
        if (savedProfileImg) {
          // 이미지 태그 찾아서 src 변경
          document.querySelector('.profile-box img').src = savedProfileImg;
        }
        if (savedBgImg) {
          // 배경 div 찾아서 style 변경
          document.querySelector('.profile-cover').style.backgroundImage = `url('${savedBgImg}')`;
        }

        // 3. 로그아웃 버튼 기능
        const logoutBtn = document.querySelector('a[href="#logout"]');
        if (logoutBtn) {
          logoutBtn.addEventListener("click", function (e) {
            e.preventDefault();
            const confirmLogout = confirm("정말 로그아웃 하시겠습니까?");
            if (confirmLogout) {
              alert("로그아웃 되었습니다.");
              // 실제로는 세션을 지우겠지만, 여기선 메인으로 이동시킵니다.
              window.location.href = "11_인공띠용지능_main.html";
            }
          });
        }

        
      });
  </script>
    <nav class="site-nav">
      <div class="container nav-inner">
        <div class="logo-area">
          <a href="11_인공띠용지능_main.html">
            <img src="11_logo.png" alt="냠냠노트 로고" class="logo-img" />
          </a>
        </div>

        <nav class="menu">
          <a href="11_인공띠용지능_main.html" class="nav-link">홈</a>
          <a href="11_인공띠용지능_menulist.html" class="nav-link">레시피</a>
          <a href="11_인공띠용지능_register.html" class="nav-link">등록</a>
          <a href="11_인공띠용지능_rank.html" class="nav-link">랭킹</a>
          <a href="11_인공띠용지능_mypage.html" class="nav-link active">마이페이지</a>
        </nav>
      </div>
    </nav>

    <main class="container page-pad">
      <section class="profile-header">
        <div class="profile-cover" role="img"></div>
        <div class="profile-box">
          <div style="margin-top: -43px; width: 88px; height: 88px">
            <img
              src="11_circle_h_icon.png"
              alt="프로필 이미지"
              style="width: 100%; height: 100%"
            />
          </div>
          <div style="text-align: center">
            <h1 class="profile-name">Haein_Cook</h1>
            <p class="profile-id">@haein_cook</p>
            <p class="profile-bio">안녕하세요!</p>
            <div style="margin-top: 20px">
              <a href="11_인공띠용지능_edit-profile.html" class="btn-outline"
                >프로필 수정</a
              >
            </div>
          </div>
        </div>
        <div class="follow">
          <div style="text-align: center">
            <strong class="follow-num">8</strong>
            <span class="follow-label">내 레시피</span>
          </div>
          <div style="text-align: center">
            <strong class="follow-num">325</strong>
            <span class="follow-label">팔로잉</span>
          </div>
          <div style="text-align: center">
            <strong class="follow-num">238</strong>
            <span class="follow-label">팔로워</span>
          </div>
        </div>
      </section>

      <section class="grid-2" style="gap: 24px; margin-top: 80px">
        <div class="card-box">
          <div class="bar" style="justify-content: space-between">
            <h3 class="card-title-lg">저장한 레시피</h3>
            <a href="#" class="badge">더보기</a>
          </div>
          <ul class="list-v" id="saved-list">
          </ul>
        </div>

        <div class="card-box">
          <div class="bar" style="justify-content: space-between">
            <h3 class="card-title-lg">최근 본 레시피</h3>
            <a href="#" class="badge">더보기</a>
          </div>
          <ul class="list-v" id="recent-list">
          </ul>
        </div>
      </section>

      <section class="card-box" style="margin-top: 80px">
        <div class="bar" style="justify-content: space-between">
          <h3 class="card-title-lg">내가 등록한 레시피</h3>
          <div class="btn-row">
            <a href="11_인공띠용지능_register.html" class="btn-solid"
              >새 레시피 등록</a
            >
            <a href="#" class="btn-warn">레시피 관리</a>
          </div>
        </div>

        <div class="card-grid my-recipes" id="my-recipes-grid">
          <!-- JS로 내 레시피 카드가 채워집니다 -->
        </div>
      </section>

      <div style="margin-top: 20px; text-align: right">
        <a href="#logout" class="btn-warn">
          <span>로그아웃</span>
        </a>
      </div>

      <a href="#top" class="to-top" aria-label="맨 위로 이동">맨 위로 ↑</a>
    </main>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // 1) 프로필 이름 → 로컬스토리지 저장
        const userNameEl = document.querySelector(".profile-name");
        const userName = userNameEl ? userNameEl.textContent.trim() : "";
        if (userName) {
          localStorage.setItem("nn_username", userName);
        }

        // 2) 저장한 레시피 리스트 (왼쪽 "저장한 레시피")
        const savedListContainer = document.getElementById("saved-list");
        const savedRecipes =
          JSON.parse(localStorage.getItem("nn_saved_recipes")) || [];

        if (savedListContainer) {
          if (savedRecipes.length === 0) {
            savedListContainer.innerHTML =
              '<li style="padding:20px; text-align:center; color:#999;">저장된 레시피가 없습니다.</li>';
          } else {
            savedListContainer.innerHTML = savedRecipes
              .map(
                (recipe) => `
                <li>
                  <a href="${recipe.link}" class="list-item">
                    <div class="list-text">
                      <p class="list-ttl">${recipe.title}</p>
                      <p class="list-sub">${recipe.subInfo || ""}</p>
                    </div>
                  </a>
                </li>
              `
              )
              .join("");
          }
        }

        // 3) 상단 프로필 카드 - "내 레시피" 개수 업데이트
        const myRecipes =
          JSON.parse(localStorage.getItem("nn_recipes")) || [];
        const followNums = document.querySelectorAll(".follow-num");
        if (followNums.length > 0) {
          // 첫 번째 숫자만 "내 레시피"이니까 거기만 변경
          followNums[0].textContent = myRecipes.length;
        }

        // 4) (선택) 내가 등록한 레시피 카드 영역
        // 나중에 <div id="my-recipes-grid">로 바꾸면 여기 코드가 동작함
        const myRecipesGrid = document.getElementById("my-recipes-grid");
        if (myRecipesGrid) {
          if (myRecipes.length === 0) {
            myRecipesGrid.innerHTML =
              '<p class="card-sub muted">아직 등록한 레시피가 없습니다. 상단의 "새 레시피 등록" 버튼으로 추가해보세요!</p>';
          } else {
            myRecipesGrid.innerHTML = myRecipes
              .map((r) => {
                const imgSrc = r.image || r.thumbnail || "11_default.png";
                const title = r.title || "제목 없는 레시피";
                const category = r.category || "기타";
                const views = r.views || 0;
                const link =
                  "11_인공띠용지능_recipe.html?id=" +
                  encodeURIComponent(String(r.id));

                return `
                  <a href="${link}" class="card">
                    <img src="${imgSrc}" alt="${title}" class="thumb" />
                    <div>
                      <p class="card-title">${title}</p>
                      <p class="card-sub">${category} · 조회수 ${views}</p>
                    </div>
                  </a>
                `;
              })
              .join("");
          }
        }

        // 5) 최근 본 레시피 리스트
        const recentListContainer = document.getElementById("recent-list");
        const recentRecipes =
          JSON.parse(localStorage.getItem("nn_recent_recipes")) || [];

        if (recentListContainer) {
          if (recentRecipes.length === 0) {
            recentListContainer.innerHTML =
              '<li style="padding:20px; text-align:center; color:#999;">최근 본 레시피가 없습니다.</li>';
          } else {
            recentListContainer.innerHTML = recentRecipes
              .map(
                (recipe) => `
                <li>
                  <a href="${recipe.link}" class="list-item">
                    <div class="list-text">
                      <p class="list-ttl">${recipe.title}</p>
                      <p class="list-sub">${recipe.info}</p>
                    </div>
                  </a>
                </li>
              `
              )
              .join("");
          }
        }
      });
    </script>
  

  </body>
</html>

<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title id="page-title">ëƒ ëƒ ë…¸íŠ¸ - ë ˆì‹œí”¼</title>

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <link rel="stylesheet" href="11_ì¸ê³µë ìš©ì§€ëŠ¥_NamyamNote_style.css" />
  </head>
  <body>
    <nav class="site-nav">
      <div class="container nav-inner">
        <div class="logo-area">
          <a href="11_ì¸ê³µë ìš©ì§€ëŠ¥_main.html" class="logo">
            <img src="11_logo.png" alt="ëƒ ëƒ ë…¸íŠ¸ ë¡œê³ " class="logo-img" />
          </a>
        </div>
        <div class="menu">
          <a href="11_ì¸ê³µë ìš©ì§€ëŠ¥_main.html" class="nav-link">í™ˆ</a>
          <a href="11_ì¸ê³µë ìš©ì§€ëŠ¥_menulist.html#all" class="active nav-link"
            >ë ˆì‹œí”¼</a
          >
          <a href="11_ì¸ê³µë ìš©ì§€ëŠ¥_register.html" class="nav-link">ë“±ë¡</a>
          <a href="11_ì¸ê³µë ìš©ì§€ëŠ¥_rank.html#ranking" class="nav-link">ë­í‚¹</a>
          <a href="11_ì¸ê³µë ìš©ì§€ëŠ¥_mypage.html" class="nav-link">ë§ˆì´í˜ì´ì§€</a>
        </div>
      </div>
    </nav>

    <main class="page-pad">
      <div class="container">
        <!-- ğŸŸ  ì—¬ê¸°ë¶€í„° JSONìœ¼ë¡œ ì±„ì›Œì§ -->
        <section class="hero">
          <img
            id="thumb"
            style="
              width: 100%;
              height: 600px;
              object-fit: cover;
              border-radius: 12px;
            "
          />

          <div>
            <h1 id="recipe-title" style="margin-top: 30px"></h1>
            <p id="recipe-summary" class="mt-20"></p>

            <div class="mt-20">
              <span id="recipe-category" class="badge-green"></span>
              <span>ë‚œì´ë„: <strong id="recipe-difficulty"></strong></span>
              <span>ì¡°ë¦¬ ì‹œê°„: <strong id="recipe-time"></strong></span>
            </div>

            <div id="recipe-rating" class="rating"></div>

            <div class="btn-row">
              <!-- ì €ì¥í•˜ê¸° ë²„íŠ¼ í™œì„±í™”(í•´ì¸) -->
              <button class="btn-solid" id="btn-save">
                <i class="fas fa-heart"></i> ì €ì¥í•˜ê¸°
              </button>
              <button class="btn-outline">
                <i class="fas fa-share-alt"></i> ê³µìœ 
              </button>
            </div>
          </div>
        </section>

        <div class="grid-2 gap-24 mt-80">
          <section class="card-box">
            <h2 class="card-title-lg">í•„ìˆ˜ ì¬ë£Œ</h2>
            <ul id="ingredients-required" class="list-v"></ul>

            <h3 class="section-title mt-20">ì„ íƒ ì¬ë£Œ</h3>
            <ul id="ingredients-optional" class="list-v"></ul>
          </section>

          <section class="card-box">
            <h2 class="card-title-lg">ì¡°ë¦¬ ê³¼ì •</h2>
            <ol id="recipe-steps" class="list-v"></ol>
          </section>
        </div>

        <section class="card-box mt-80">
          <h2 id="review-title" class="card-title-lg"></h2>

          <div class="review-area">
            <div class="review-input-box">
              <textarea
                class="input-text"
                placeholder="ì´ ë ˆì‹œí”¼ì— ëŒ€í•œ ë‹¹ì‹ ì˜ ë¦¬ë·°ë¥¼ ë‚¨ê²¨ì£¼ì„¸ìš”!"
              ></textarea>

              <div class="btn-row between">
                <div class="rating-stars">
                  <i class="far fa-star"></i>
                  <i class="far fa-star"></i>
                  <i class="far fa-star"></i>
                  <i class="far fa-star"></i>
                  <i class="far fa-star"></i>
                </div>

                <button class="btn-solid">ë¦¬ë·° ë“±ë¡</button>
              </div>
            </div>

            <div id="review-list" class="review-list"></div>
          </div>
        </section>
      </div>
    </main>

    <a href="#top" class="to-top">ë§¨ ìœ„ë¡œ â†‘</a>

    <script src="11_ì¸ê³µë ìš©ì§€ëŠ¥_recipeLoader.js"></script>
  <!--ì €ì¥ë²„íŠ¼ í™œì„±í™” (í•´ì¸) -->
    <script>
    document.addEventListener("DOMContentLoaded", function() {
      const saveBtn = document.getElementById("btn-save");
      
      // í˜„ì¬ í˜ì´ì§€ URLì—ì„œ ë ˆì‹œí”¼ ID íŒŒì‹± (ì˜ˆ: ?id=kimchi)
      // ë§Œì•½ URL íŒŒë¼ë¯¸í„°ë¥¼ ì•ˆ ì“´ë‹¤ë©´ ì„ì˜ì˜ ì‹ë³„ìê°€ í•„ìš”í•©ë‹ˆë‹¤.
      const urlParams = new URLSearchParams(window.location.search);
      const recipeId = urlParams.get('id') || 'unknown_recipe'; 

      saveBtn.addEventListener("click", function() {
        // 1. í˜„ì¬ í™”ë©´ì— í‘œì‹œëœ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        const title = document.getElementById("recipe-title").innerText;
        const category = document.getElementById("recipe-category").innerText;
        // ë‚œì´ë„ë‚˜ ì‘ê°€ ì •ë³´ê°€ ìˆë‹¤ë©´ ê°€ì ¸ì˜¤ê¸° (ì—¬ê¸°ì„  ì˜ˆì‹œë¡œ ì²˜ë¦¬)
        const subInfo = category + " Â· ì €ì¥ëœ ë ˆì‹œí”¼"; 
        
        // 2. ì €ì¥í•  ê°ì²´ ë§Œë“¤ê¸°
        const recipeData = {
          id: recipeId,
          title: title,
          subInfo: subInfo,
          link: window.location.href // í˜„ì¬ í˜ì´ì§€ ì£¼ì†Œ
        };

        // 3. ê¸°ì¡´ ì €ì¥ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°
        let savedRecipes = JSON.parse(localStorage.getItem("nn_saved_recipes")) || [];

        // 4. ì¤‘ë³µ ì²´í¬ (ì´ë¯¸ ì €ì¥ëœ ê±°ë©´ ì‚­ì œ or ì•Œë¦¼)
        const existingIndex = savedRecipes.findIndex(item => item.id === recipeId && item.title === title);
        
        if (existingIndex !== -1) {
          // ì´ë¯¸ ìˆìœ¼ë©´ ì‚­ì œ(ì €ì¥ ì·¨ì†Œ) ë¡œì§
          savedRecipes.splice(existingIndex, 1);
          alert("ì €ì¥ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.");
          saveBtn.innerHTML = '<i class="fas fa-heart"></i> ì €ì¥í•˜ê¸°'; // ì•„ì´ì½˜ ì›ë³µ
        } else {
          // ì—†ìœ¼ë©´ ì¶”ê°€
          savedRecipes.push(recipeData);
          alert("ë ˆì‹œí”¼ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!");
          saveBtn.innerHTML = '<i class="fas fa-check"></i> ì €ì¥ë¨'; // ì•„ì´ì½˜ ë³€ê²½
        }

        // 5. ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ë‹¤ì‹œ ì €ì¥
        localStorage.setItem("nn_saved_recipes", JSON.stringify(savedRecipes));
      });
    });
  </script>
  </body>
</html>
